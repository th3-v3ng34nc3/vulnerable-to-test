name: AccuKnox Scan Workflow

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  accuknox-cicd:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@main  
     
      - name: Run AccuKnox CSPM Scan
        uses: ./
        with:
          token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJ0b2tlbl90eXBlIjoic2xpZGluZyIsImV4cCI6MTcwNzg1MTcyNywianRpIjoiOTQ1Zjk0NzY1YjRlNDEzM2IwMzhiM2Y1ODNkNGViZjUiLCJyZWZyZXNoX2V4cCI6MTcwNzg4MDEwOCwidXNlcl9pZCI6NjU1Nywic3ViIjoiNjU1NyIsImlhdCI6MTcwNzc5MzcwOCwidGVuYW50LWlkIjoxMDY5LCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZXhwb3J0X2RhdGFsaXN0IiwiY3JlYXRlX2xhYmVscyIsImRlbGV0ZV9sYWJlbHMiLCJ2aWV3X2ZpbmRpbmdzIiwiY3JlYXRlX2ZpbmRpbmdzX2NvbmZpZyIsImRlbGV0ZV9maW5kaW5nc19jb25maWciLCJmaW5kaW5nc19hZGRfdG9fZ3JvdXAiLCJmaW5kaW5nc19hZGRfdG9fdGFyZ2V0IiwidXBkYXRlX2ZpbmRpbmdzIiwiaWdub3JlX2ZpbmRpbmdzIiwiZ2V0X2FsbF9jbHVzdGVycyIsImdldF90cmlnZ2Vyc19maWx0ZXJzIiwiZGVsZXRlX2RhdGFwaXBlbGluZV90cmlnZ2VycyIsImN3cHBfZGVsZXRlX2xhYmVscyIsImN3cHBfZWRpdF9yZWdpc3RyeSIsImN3cHBfYWRkX3JlZ2lzdHJ5IiwiZXhwb3J0X2ZpbmRpbmdzIiwiZGVsZXRlX2ZpbmRpbmdfY29tbWVudHMiLCJ2aWV3X2Jhc2VsaW5lcyIsImNyZWF0ZV9iYXNlbGluZXMiLCJkZWxldGVfYmFzZWxpbmVzIiwidmlld190YXJnZXRzIiwiY3dwcF9nZXRfbGFiZWxzIiwiZ2V0X2RhdGFwaXBlbGluZV90ZWxlbWV0cnkiLCJjd3BwX2dldF9yZWdpc3RyeSIsImN3cHBfZ2V0X3RhZ3MiLCJjd3BwX2RlbGV0ZV9sYWJlbF9lbnRpdGllcyIsImFkZF9wb2xpY3kiLCJjd3BwX2FkZF9sYWJlbHMiLCJhcHByb3ZlX3BvbGljeSIsImdldF9wb2xpY3kiLCJlZGl0X3BvbGljeSIsImNyZWF0ZV90YXJnZXRzIiwiZGVsZXRlX3RhcmdldHMiLCJ2aWV3X3RpY2tldHMiLCJjcmVhdGVfcmVwb3J0cyIsInZpZXdfbW9uaXRvcnMiLCJjcmVhdGVfbW9uaXRvcnMiLCJjcmVhdGVfY2xvdWRfYWNjb3VudHMiLCJkZWxldGVfY2xvdWRfYWNjb3VudHMiLCJkZWxldGVfY29uZGl0aW9uIiwidmlld19taW5pb25zIiwiY3JlYXRlX21pbmlvbnMiLCJkZWxldGVfbWluaW9ucyIsInZpZXdfbW9kdWxlcyIsInZpZXdfZnVuY3Rpb25zIiwidmlld19leHBlY3RlZF92YXJpYWJsZSIsInZpZXdfY29tbWVudHNfYW5hbHlzaXMiLCJjcmVhdGVfY29tbWVudHNfYW5hbHlzaXMiLCJkZWxldGVfY29tbWVudHNfYW5hbHlzaXMiLCJ2aWV3X2NoZWNrcyIsInZpZXdfdXNlcnMiLCJjcmVhdGVfdXNlcnMiLCJkZWxldGVfdXNlcnMiLCJ2aWV3X25vdGlmaWNhdGlvbnMiLCJjcmVhdGVfbm90aWZpY2F0aW9ucyIsImRlbGV0ZV9ub3RpZmljYXRpb25zIiwidmlld19jb250cm9scyIsImNyZWF0ZV9jb250cm9scyIsImRlbGV0ZV9jb250cm9scyIsInZpZXdfYXNrYWRhX2NoYXQiLCJ2aWV3X2Fza2FkYV9jb252ZXJzYXRpb24iLCJ2aWV3X2Fza2FkYV9mZWVkYmFjayIsImFzc2V0c19hZGRfdGFnIiwiYXNzZXRzX3VwZGF0ZV9iYXNlbGluZXMiLCJ2aWV3X2xhYmVscyIsImFkZF90YWdfZmluZGluZ3MiLCJ2aWV3X2ZpbmRpbmdfY29tbWVudHMiLCJjcmVhdGVfZmluZGluZ19jb21tZW50cyIsImNyZWF0ZV90aWNrZXRzIiwiZGVsZXRlX3RpY2tldHMiLCJ2aWV3X3JlcG9ydHMiLCJkZWxldGVfcmVwb3J0cyIsImNyZWF0ZV9zZXR0aW5ncyIsImRlbGV0ZV9zZXR0aW5ncyIsInZpZXdfcGxheWJvb2tzIiwiY3JlYXRlX3BsYXlib29rcyIsImRlbGV0ZV9wbGF5Ym9va3MiLCJ2aWV3X2Nsb3VkX2FjY291bnRzIiwidmlld19jb25kaXRpb24iLCJkZWxldGVfbW9uaXRvcnMiLCJ2aWV3X3NldHRpbmdzIiwiZGFzaGJvYXJkIiwidmlld19zY2FucyIsInJ1bl9zY2FucyIsInRhZ19zY2FucyIsImRlbGV0ZV9zY2FucyIsImRlbGV0ZV90YWdzIiwidmlld19ncm91cHMiLCJjcmVhdGVfZ3JvdXBzIiwiZGVsZXRlX2dyb3VwcyIsInZpZXdfZGF0YWxpc3QiLCJkYXRhbGlzdF9hZGRfdG9fZ3JvdXAiLCJkYXRhbGlzdF9hZGRfdG9fdGFyZ2V0Iiwidmlld19hc3NldHMiLCJ2aWV3X2VudGl0aWVzIiwic2NyZWVuIiwiY3JlYXRlX2NvbmRpdGlvbiIsImN3cHBfZWRpdF9sYWJlbHMiLCJjd3BwX2FkZF9sYWJlbF9lbnRpdGllcyIsImN3cHBfZGVsZXRlX3RhZ3MiLCJnZXRfZGF0YXBpcGVsaW5lX2ZpbHRlcnMiLCJkZWxldGVfY2hhbm5lbF9pbnRlZ3JhdGlvbnMiLCJkZWxldGVfdHJpZ2dlcnNfZmlsdGVycyIsImN5YmVyYWlkZSIsImdldF9kYXRhcGlwZWxpbmVfdHJpZ2dlcnMiLCJ1cGRhdGVfZGF0YXBpcGVsaW5lX3RyaWdnZXJzIiwiY2hhbmdlX3BvbGljeV9zdGF0dXMiLCJzYXZlX3RyaWdnZXJzX2ZpbHRlcnMiLCJkZWxldGVfZGF0YXBpcGVsaW5lX2ZpbHRlcnMiLCJzYXZlX2RhdGFwaXBlbGluZV9maWx0ZXJzIiwiaWdub3JlX3BvbGljeSIsInZpZXdfYXNzZXRfcGFuZWwiLCJjcmVhdGVfZGF0YXBpcGVsaW5lX3RyaWdnZXJzIiwidmlld190YWdzIiwiY3JlYXRlX3RhZ3MiLCJjcmVhdGVfZGF0YWxpc3RfY29uZmlnIiwiZGVsZXRlX2RhdGFsaXN0X2NvbmZpZyIsImN3cHBfZ2V0X2xhYmVsX2VudGl0aWVzIiwiZGVsZXRlX3BvbGljeSIsImN3cHBfZ2V0X3JlZ2lzdHJ5X3NjYW5zIiwiZ2V0X2FwcF9iZWhhdmlvciIsImN3cHBfZGVsZXRlX3JlZ2lzdHJ5IiwidXBkYXRlX2RhdGFwaXBlbGluZV9maWx0ZXJzIiwiY3dwcF9hZGRfdGFncyIsInRlc3RfY2hhbm5lbF9pbnRlZ3JhdGlvbnMiLCJnZXRfY2hhbm5lbF9pbnRlZ3JhdGlvbnMiLCJzYXZlX2NoYW5uZWxfaW50ZWdyYXRpb25zIl19LCJpc3MiOiJjc3BtLmRldi5hY2N1a25veC5jb20ifQ.eK5xJHX3zgvg46GcT_PoatuROhthJKyu73OTdNsbQ6uiI4CGw86_Wr_BQm_cjlq9PCkSe8hRRD1OjB274_hK9cE2LLQA_CQd2owFBouwUEhfWuihE1iTl2nUxOJlLOu-Bkbh7FCqh4jiCRoYj-BDcQYSbEd4dIerZriSvYZ7KWWfW9cLKZpZMkMc0iOxLIGgLxKSoKIW89N2SAqf0tW7J1bALR9-Cpg8WQx-_iLTYJeVYBVG-qv4vsmwkTbxwFbUcbPJ_mC4cN6MxbToGrem3E9MoQmuhXwf1XUHiDP9wx7aTT4Ax6lyh947UtdMadR3eb3-ZfI2SBhGpP7sBS9hHg"
          tenant_id: "1069"
          severity: "CRITICAL"
          code: "0"
          repository_name: "udit-uniyal/vulnerable-to-test"
          endpoint: "cspm.dev.accuknox.com"
         
